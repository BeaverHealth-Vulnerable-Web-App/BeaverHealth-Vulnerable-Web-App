<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use Illuminate\Support\Facades\Auth;

class VulnerabilityTogglesController extends Controller
{
    protected $user;

    public function __construct()
    {
        $this->user = Auth::user();
    }

    public function index()
    {
        return view('vuln_toggles.index', ['user' => $this->user]);
    }

    public function store(Request $request)
    {
        $this->user->sqli_on = $request->has('sql_injection');
        $this->user->cmd_inject_on = $request->has('command_injection');
        $this->user->idor_on = $request->has('idor');
        $this->user->file_upload_on = $request->has('file_upload');
        $this->user->xss_stored_on = $request->has('stored_xss');
        $this->user->xss_reflected_on = $request->has('reflected_xss');

        $this->user->save();
        return redirect()->route('vulnerability_toggles');
    }
}
